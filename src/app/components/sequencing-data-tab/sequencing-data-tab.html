<mat-card appearance="outlined" class="region-size-settings-card">
  <mat-card-content>
    <div class="settings-grid">
      <!-- Column 1: Axis Units -->
      <div class="settings-column">
        <p class="settings-label">
          To change the default units of the Number Axis, select one of the options below:
        </p>
        <mat-radio-group [formField]="sequencingForm.axisUnit" class="radio-row" aria-label="Number Axis Units">
          <mat-radio-button value="count">Count</mat-radio-button>
          <mat-radio-button value="percentage">Percentage</mat-radio-button>
        </mat-radio-group>
      </div>

      <mat-divider vertical/>

      <!-- Column 2: Randomized Region Size -->
      <div class="settings-column">
        <p class="settings-label">
          To view the randomized region size distribution for different lengths, select the desired value below.
          By default, the randomized region size with the most reads is displayed.
        </p>
        <mat-form-field appearance="outline" class="size-select">
          <mat-label>Randomized Region Size</mat-label>
          <mat-select [formField]="sequencingForm.selectedRegionSize">
            @for (size of randomizedRegionSizes(); track size) {
              <mat-option [value]="size">{{ size }}</mat-option>
            }
          </mat-select>
        </mat-form-field>
      </div>

      <mat-divider vertical></mat-divider>

      <!-- Column 3: Axis Scale -->
      <div class="settings-column">
        <p class="settings-label">
          To change the default scale of the randomized region size bar chart, select one of the options below:
        </p>
        <mat-radio-group [formField]="sequencingForm.axisScale" class="radio-row" aria-label="Number Axis Scale">
          <mat-radio-button value="linear">Linear</mat-radio-button>
          <mat-radio-button value="logarithmic">Logarithmic</mat-radio-button>
        </mat-radio-group>
      </div>
    </div>
  </mat-card-content>
</mat-card>

<mat-card appearance="outlined">
  <mat-card-header>
    <mat-card-title>Selection Cycle {{ experimentReport()!.selectionCycleResponse.round }}: {{ experimentReport()!.selectionCycleResponse.name }} (Positive Selection)</mat-card-title>
  </mat-card-header>
  <mat-card-content>
    <mat-card appearance="filled">
      <mat-card-header>
        <mat-card-title>Cycle Information</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="meta-grid">
          <mat-card appearance="outlined" class="meta-card">
            <mat-card-content>
              <div class="meta-label">Round Number</div>
              <div class="meta-value">{{ experimentReport()!.selectionCycleResponse.round }}</div>
            </mat-card-content>
          </mat-card>
          <mat-card appearance="outlined" class="meta-card">
            <mat-card-content>
              <div class="meta-label">Cycle Id</div>
              <div class="meta-value">{{ experimentReport()!.selectionCycleResponse.name }}</div>
            </mat-card-content>
          </mat-card>
          <mat-card appearance="outlined" class="meta-card">
            <mat-card-content>
              <div class="meta-label">Type of Selection</div>
              <div class="meta-value">{{ experimentReport()!.selectionCycleResponse.isControlSelection ? 'Control' : experimentReport()!.selectionCycleResponse.isCounterSelection ? 'Negative' : 'Positive' }}</div>
            </mat-card-content>
          </mat-card>
          <mat-card appearance="outlined" class="meta-card">
            <mat-card-content>
              <div class="meta-label">5' Barcode</div>
              <div class="meta-value">{{ experimentReport()!.selectionCycleResponse.barcode5Prime ?? 'N/A' }}</div>
            </mat-card-content>
          </mat-card>
          <mat-card appearance="outlined" class="meta-card">
            <mat-card-content>
              <div class="meta-label">3' Barcode</div>
              <div class="meta-value">{{ experimentReport()!.selectionCycleResponse.barcode3Prime ?? 'N/A' }}</div>
            </mat-card-content>
          </mat-card>
          <mat-card appearance="outlined" class="meta-card">
            <mat-card-content>
              <div class="meta-label">Pool Size</div>
              <div class="meta-value">{{ experimentReport()!.selectionCycleResponse.totalSize }}</div>
            </mat-card-content>
          </mat-card>
          <mat-card appearance="outlined" class="meta-card">
            <mat-card-content>
              <div class="meta-label">Unique Fraction</div>
              <div class="meta-value">{{ experimentReport()!.selectionCycleResponse.uniqueSize }}</div>
            </mat-card-content>
          </mat-card>
          <mat-card appearance="outlined" class="meta-card base-distribution">
            <mat-card-content>
              <div class="meta-label">Base Distribution (%)</div>
              <div class="meta-value">
                @for (baseEntry of baseDistributionPercentages() | keyvalue; track baseEntry.key) {
                  <span>{{ baseEntry.key }}: {{ baseEntry.value | number: '1.2-2' }}</span>
                }
              </div>
            </mat-card-content>
          </mat-card>
        </div>
      </mat-card-content>
    </mat-card>
    <div echarts [options]="forwardReadsNucleotideDistributionRawChartOptions()" class="chart-container" [autoResize]="true"></div>
    <div echarts [options]="reverseReadsNucleotideDistributionRawChartOptions()" class="chart-container" [autoResize]="true"></div>
    <div echarts [options]="acceptedReadsNucleotideDistributionChartOptions()" class="chart-container" [autoResize]="true"></div>
  </mat-card-content>
</mat-card>
